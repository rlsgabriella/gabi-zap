2025-11-12 22:31:49,832 [INFO] Logger inicializado.
2025-11-12 22:31:49,832 [INFO] Carregando webdriver...
2025-11-12 22:31:49,833 [INFO] ====== WebDriver manager ======
2025-11-12 22:31:51,918 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:31:52,298 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:31:52,617 [INFO] There is no [win64] chromedriver "142.0.7444.162" for browser google-chrome "142.0.7444" in cache
2025-11-12 22:31:52,618 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:31:53,309 [INFO] WebDriver version 142.0.7444.162 selected
2025-11-12 22:31:53,314 [INFO] Modern chrome version https://storage.googleapis.com/chrome-for-testing-public/142.0.7444.162/win32/chromedriver-win32.zip
2025-11-12 22:31:53,316 [INFO] About to download new driver from https://storage.googleapis.com/chrome-for-testing-public/142.0.7444.162/win32/chromedriver-win32.zip
2025-11-12 22:31:53,825 [INFO] Driver downloading response is 200
2025-11-12 22:31:55,100 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:31:56,418 [INFO] Driver has been saved in cache [C:\Users\gabriella.lopes\.wdm\drivers\chromedriver\win64\142.0.7444.162]
2025-11-12 22:32:01,236 [INFO] Aguardando login no WhatsApp Web (escaneie o QR code se necessário)...
2025-11-12 22:32:04,266 [ERROR] Erro crítico na execução principal: ('Connection aborted.', ConnectionResetError(10054, 'Foi forçado o cancelamento de uma conexão existente pelo host remoto', None, 10054, None))
Traceback (most recent call last):
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
  File "C:\Python313\Lib\http\client.py", line 1430, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\http\client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\http\client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Python313\Lib\socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
ConnectionResetError: [WinError 10054] Foi forçado o cancelamento de uma conexão existente pelo host remoto

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\gabriella.lopes\Downloads\gabi-zap\app.py", line 448, in main
    wait.until(EC.presence_of_element_located((By.ID, "side")))
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\selenium\webdriver\support\wait.py", line 129, in until
    value = method(self._driver)
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\selenium\webdriver\support\expected_conditions.py", line 104, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\selenium\webdriver\remote\webdriver.py", line 926, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\selenium\webdriver\remote\webdriver.py", line 455, in execute
    response = cast(RemoteConnection, self.command_executor).execute(driver_command, params)
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\selenium\webdriver\remote\remote_connection.py", line 407, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\selenium\webdriver\remote\remote_connection.py", line 431, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\poolmanager.py", line 459, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\util\retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\util\util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "C:\Users\gabriella.lopes\AppData\Roaming\Python\Python313\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
  File "C:\Python313\Lib\http\client.py", line 1430, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\http\client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\http\client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Python313\Lib\socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(10054, 'Foi forçado o cancelamento de uma conexão existente pelo host remoto', None, 10054, None))
2025-11-12 22:32:18,907 [WARNING] Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000022DB3AA74D0>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente')': /session/61ac507c789f5a3c377b490a0236f806
2025-11-12 22:32:23,018 [WARNING] Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000022DB3AA7610>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente')': /session/61ac507c789f5a3c377b490a0236f806
2025-11-12 22:32:27,129 [WARNING] Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000022DB3AC7E10>: Failed to establish a new connection: [WinError 10061] Nenhuma conexão pôde ser feita porque a máquina de destino as recusou ativamente')': /session/61ac507c789f5a3c377b490a0236f806
2025-11-12 22:32:31,198 [INFO] Webdriver finalizado.
2025-11-12 22:32:51,374 [INFO] Logger inicializado.
2025-11-12 22:32:51,375 [INFO] Carregando webdriver...
2025-11-12 22:32:51,391 [INFO] ====== WebDriver manager ======
2025-11-12 22:32:52,411 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:32:52,690 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:32:52,945 [INFO] Driver [C:\Users\gabriella.lopes\.wdm\drivers\chromedriver\win64\142.0.7444.162\chromedriver-win32/chromedriver.exe] found in cache
2025-11-12 22:32:55,341 [INFO] Aguardando login no WhatsApp Web (escaneie o QR code se necessário)...
2025-11-12 22:34:00,463 [INFO] Login detectado.
2025-11-12 22:34:01,315 [INFO] Contatos carregados para envio: 5
2025-11-12 22:34:01,316 [INFO] Fora das janelas de envio configuradas.
2025-11-12 22:34:01,316 [INFO] Aguardando janela de envio...
2025-11-12 22:34:24,023 [INFO] Logger inicializado.
2025-11-12 22:34:24,023 [INFO] Carregando webdriver...
2025-11-12 22:34:24,024 [INFO] ====== WebDriver manager ======
2025-11-12 22:34:25,039 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:34:25,337 [INFO] Get LATEST chromedriver version for google-chrome
2025-11-12 22:34:25,695 [INFO] Driver [C:\Users\gabriella.lopes\.wdm\drivers\chromedriver\win64\142.0.7444.162\chromedriver-win32/chromedriver.exe] found in cache
2025-11-12 22:34:27,974 [INFO] Aguardando login no WhatsApp Web (escaneie o QR code se necessário)...
2025-11-12 22:34:32,707 [INFO] Login detectado.
2025-11-12 22:34:33,457 [INFO] Contatos carregados para envio: 5
2025-11-12 22:34:33,459 [INFO] Preparando envio para 558592268967 (método de colar)
2025-11-12 22:34:41,240 [INFO] Mensagem colada para 558592268967
2025-11-12 22:34:46,017 [INFO] Enviado para 558592268967
2025-11-12 22:36:25,855 [INFO] Preparando envio para 558594329894 (método de colar)
2025-11-12 22:36:34,476 [INFO] Mensagem colada para 558594329894
2025-11-12 22:36:39,148 [INFO] Enviado para 558594329894
2025-11-12 22:38:20,884 [INFO] Preparando envio para 558599229911 (método de colar)
2025-11-12 22:38:32,019 [INFO] Mensagem colada para 558599229911
2025-11-12 22:38:35,651 [INFO] Enviado para 558599229911
2025-11-12 22:40:21,185 [INFO] Preparando envio para 558589731506 (método de colar)
2025-11-12 22:40:35,749 [INFO] Mensagem colada para 558589731506
2025-11-12 22:40:40,388 [INFO] Enviado para 558589731506
2025-11-12 22:42:41,952 [INFO] Preparando envio para 558597963325 (método de colar)
2025-11-12 22:43:08,200 [INFO] Mensagem colada para 558597963325
2025-11-12 22:43:11,459 [INFO] Enviado para 558597963325
2025-11-12 22:43:11,700 [INFO] Persistidos 5 envios em enviados.xlsx
2025-11-12 22:43:11,701 [INFO] Execução finalizada do SafeSender.
